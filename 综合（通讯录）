#define _CRT_SECURE_NO_WARNINGS 1
#include <stdio.h>
#include <windows.h>
#include <stdlib.h>
#include <string.h>
#define MAX 1000
#define MAX_name 20
#define MAX_tele 12
#define MAX_add 20
//定义信息结构体
struct mem
{
	char name[MAX_name];
	int age;
	char tele[MAX_tele];
	char add[MAX_add];
};
//定义储存结构体
struct dest
{
	struct mem x[MAX];
	int size;//存放的数量
};
//打印菜单
void menu()
{
	printf("******************************\n");
	printf("****1.增加          2.删除****\n");
	printf("****3.查找          4.修改****\n");
	printf("****5.打印          0.退出****\n");
	printf("******************************\n");
}
//查找信息
static int Findmember(const struct dest*sp, char* name)
{
	int a = 0;
	for (a = 0;a < sp->size;a++)
	{
		if (strcmp(name, sp->x[a].name) == 0)
		{
			return a;
		}
	}
	return -1;
}
//初始化
void init(struct dest* sp)
{
	memset(sp->x, 0, sizeof(sp->x));
	sp->size = 0;//设置通讯录最初只有 0 个元素
}
//修改通讯录信息
void motify(struct dest* sp)
{
	char name[MAX_name];
	printf("你要修改的是:");
	scanf("%s", name);
	int ret = Findmember(sp, name);
	if(ret == 1)
		printf("未找到\n");
	else
	{
		printf("姓名：");
		scanf("%s", sp->x[ret].name);
		printf("年龄：");
		scanf("%d", &(sp->x[ret].age));
		printf("电话：");
		scanf("%s", sp->x[ret].tele);
		printf("地址：");
		scanf("%s", sp->x[ret].add);
		printf("修改成功\n");
	}	
	Sleep(1000);
}
//查找通讯录信息
void search(const struct dest* sp)
{
	char name[MAX_name];
	printf("请输入查找的人是:");
	scanf("%s", name);
	int ret = Findmember(sp,name);
	if (ret == -1)
		printf("未找到\n");
	else
	{
		printf("找到了，显示如下:\n");
		printf("%-12s\t%-12s\t%-12s\t%-12s\n", "姓名", "年龄", "电话", "地址");
		printf("%-12s\t%-12d\t%-12s\t%-12s\n",
			sp->x[ret].name,
			sp->x[ret].age,
			sp->x[ret].tele,
			sp->x[ret].add );
	}
	printf("查找完毕\n");
	Sleep(1000);
}
//删减通讯录信息
void decrease(struct dest* sp)
{
	char name[MAX_name];
	printf("你要删除的是：");
	scanf("%s", name);
	int ret = Findmember(sp, name);
	if (ret == -1)
		printf("要删除的人不存在\n");
	else
	{
		int j = 0;
		for (j = ret;j < sp-> size - 1;j++)
		{
			sp->x[j] = sp->x[j + 1];
		}
		sp->size--;
		printf("删除成功\n");
	}
	Sleep(1000);
}
//增加通讯录信息
void increase(struct dest* sp)
{
	if (sp->size == 1000)
		printf("通讯录已满\n");
	else
	{	
		printf("姓名：");
		scanf("%s", sp->x[sp->size].name);
		printf("年龄：");
		scanf("%d", &(sp->x[sp->size].age));
		printf("电话：");
		scanf("%s", sp->x[sp->size].tele);
		printf("地址：");
		scanf("%s", sp->x[sp->size].add);
		sp->size++;
		printf("添加成功\n");
	}
	Sleep(1000);
}
//打印通讯录
void print(const struct dest* sp)
{
	if (sp->size == 0)
	{
		printf("通讯录为空,请先添加!\n");
		Sleep(1000);
	}
	else
	{
		printf("%-12s\t%-12s\t%-12s\t%-12s\n", "姓名", "年龄", "电话", "地址");
		int i = 0;
		for (i = 0;i < sp->size;i++)
		{
			printf("%-12s\t%-12d\t%-12s\t%-12s\n", 
				sp->x[i].name,
		        sp->x[i].age,
		        sp->x[i].tele,
			    sp->x[i].add);
		} 
	}
	Sleep(1000);
}
enum Option
{
	EXIT,
	ADD,
	DEF,
	SCH,
	MTF,
	PNT,
	SRT
};
int main()
{
	//可以存放1000个信息
	struct dest m;
	//初始化
	init(&m);
	int input = 0;
	do
	{
		menu();
		printf("你选择：");
		scanf("%d", &input);
		switch (input)
		{
		case ADD:
			increase(&m);
			break;
		case DEF:
			decrease(&m);
			break;
		case SCH:
			search(&m);
			break;
		case MTF:
			motify(&m);
			break;
		case PNT:
			print(&m);
			break;
		case EXIT:
			printf("正在退出\n");
			Sleep(1000);
			system("cls");
			break;
		default:
			printf("输入非法\n");
			break;
		}
	} while (input);		
		return 0;
}
